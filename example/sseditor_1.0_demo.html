<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>说说编辑器</title>
<style type="text/css">
body{font-size: 12px;}
.fl,.fr{display:inline}
.fl{float:left}
.fr{float:right}
.clear{zoom:1;}
.clear:after{visibility:hidden;display:block;font-size:0;content:" ";clear:both;height:0;}
.metionuser{background:none;}

.sseditor{width:400px;margin:0 auto;}
.editorwrap{position:relative;left:0;top:0;height:100px;border:1px solid #ccc;}
.editorwrap iframe{position:absolute;left:0;top:0;width:100%;height:100%;}

.opbar span{margin-right:20px;}
</style>
</head>
<body>
	
	<div class="sseditor">
		<div class="editorwrap">
			<textarea name="" id="J_sseditor"></textarea>
		</div>
		<div class="clear">
			<div class="fr numpost"><span><em id="J_inputlen">0</em>/<strong>140</strong></span><input id="J_post" type="button" value="发布" /></div>
			<div class="fl opbar"><span id="J_emotion"><i></i>表情按钮</span><span><i></i>上传图片</span></div>
		</div>
	</div>
	
	
	
	<img class="metionuser" alt="123" />
	<a href="javascript:;" id="a">添加内容到已保存选区中</a>
	<input id="btn" type="button" value="添加内容到已保存选区中" />
	<div id="emotion">添加内容到已保存选区中</div>
	<div id="J_editor"></div>
	<div id="J_append">拖拽文本测试</div>
	<div id="test" style="border:1px solid #f00;">测试复制数据</div>
	<div>sadhjaskh<img src="images/1_close.png" /></div>
	
<script type="text/javascript" src="../src/sseditor.js"></script>
<script>
var i = 0,
	J_inputlen = $id('J_inputlen'),
	editor = ssEditor('J_sseditor', {
	//'defaultContents': '123',
	'onReady': function(ifr){
		//console.log(this, ifr);
		var _this = this, ifrwin = ifr.contentWindow,
			ifrdoc = ifrwin.document, ifrbody = ifrdoc.body;
		//_this.text('<div style="background:#f00">123</div>');
		//ifrbody.innerHTML = '<span contenteditable="false">to:cao</span>asda<img src="images/1_close.png" title="123" />';
		_this.focus();
		$id('btn').onclick = 
		$id('a').onclick = 
		$id('emotion').onclick = function(){
			_this.insertHtmlAtCaret(i++);
		};
		$id('J_emotion').onclick = function(){
			_this.insertHtmlAtCaret('<img class="J_emotion'+ ssEditor.timeStamp +'" title="大笑" src="images/1_close.png" />');
		};
		$id('J_post').onclick = function(){
			//_this.editor.contentWindow.document.body.innerText = _this.ssContents()
			alert(_this.ssContents())
		}
	},
	cssRules: 'body span{background:#ff0;}',
	onChange: function(e, l){
		J_inputlen.innerHTML = l;
		log(e, l, this.sscontLenth)
	}
});

function $id(id){
	return document.getElementById(id);
}
function log(){
	if(window.console){
		console.log(Array.prototype.slice.apply(arguments, [0]))
	}else{
		window.status = Array.prototype.slice.apply(arguments, [0]);
	}
}
</script>
</body>
</html>